# Search Eletronics API

Dedicated repository for storing [ebusca website](http://ebusca.link/) back end. The back end was writen in Python language using FastAPI framework and has 3 endpoints:

- **get_search_results**: endpoint used to get results from crawlers (located at [My Crawlers](https://github.com/Marinarg/my_crawlers) repository) in MySQL DB using the user searched term on [ebusca website](http://ebusca.link/);
- **post_search_profile**: endpoint used to post the term searched for by the user, as well as their unique ID and date and time of execution. This information will be used in the website's recommendation system;
- **get_recommendations_results**: endpoint used to get recommendation results, using data stored from the endpoint listed above and the Kmeans model generated on [this Airflow DAG](https://github.com/Marinarg/airflow/blob/main/dags/daily_generate_kmeans_model.py).

## Installation Instructions

This project currently uses:
- Python 3.6.8
- FastAPI 0.70.0

1. Install Miniconda:
- `wget -q https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh`
- `chmod +x Miniconda3-latest-Linux-x86_64.sh`
- `./Miniconda3-latest-Linux-x86_64.sh`
- `export PATH="/home/<YOUR-USER>/miniconda3/bin:$PATH" source ~/.bashrc`

2. Create a Python environment, activate and install requirements:
- `conda create -n search_eletronics_api python=3.6`
- `conda activate search_eletronics_api`
- `pip install -r requirements.txt`

## Using the API

In order to make a request to this API, you can use Python requests library as follows:

```python
import requests

search_string  = "led vermelho"
search_profile = {"uniqueId": "0555", "search": "led vermelho"}

response_get_search_results          = requests.get(f"http://3.20.168.53:8000/{search_string}")
response_post_search_profile         = requests.post(f"http://3.20.168.53:8000/{search_profile}")
response_get_recommendations_results = requests.get(f"http://3.20.168.53:8000/{search_string}/recommendations")
```

PS: the `search_string` and `search_profile` above are just some examples of values, in fact the uniqueID used in `search_profile` is automatically generated by the front end of the website.